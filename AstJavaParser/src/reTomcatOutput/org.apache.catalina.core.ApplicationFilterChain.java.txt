ClassOrInterfaceDeclaration
	FieldDeclaration
		VariableDeclarator
			lastServicedRequest
	FieldDeclaration
		VariableDeclarator
			lastServicedResponse
	BlockStmt
		IfStmt
			Globals
			BlockStmt
				lastServicedRequest
				NullLiteralExpr
				lastServicedResponse
				NullLiteralExpr
			BlockStmt
				lastServicedRequest
				lastServicedResponse
	FieldDeclaration
		VariableDeclarator
			INCREMENT
			PrimitiveType
	ConstructorDeclaration
		BlockStmt
	FieldDeclaration
		VariableDeclarator
			filters
	FieldDeclaration
		VariableDeclarator
			pos
			PrimitiveType
	FieldDeclaration
		VariableDeclarator
			n
			PrimitiveType
	FieldDeclaration
		VariableDeclarator
			NullLiteralExpr
			servlet
	FieldDeclaration
		VariableDeclarator
			getManager
				Constants
				StringManager
			sm
	FieldDeclaration
		VariableDeclarator
			NullLiteralExpr
			support
	FieldDeclaration
		VariableDeclarator
			ArrayInitializerExpr
				ClassExpr
				ClassExpr
				ClassExpr
			classType
	FieldDeclaration
		VariableDeclarator
			ArrayInitializerExpr
				ClassExpr
				ClassExpr
			classTypeUsedInService
	FieldDeclaration
		VariableDeclarator
			ArrayInitializerExpr
				ClassExpr
				ClassExpr
			cometClassType
	FieldDeclaration
		VariableDeclarator
			ArrayInitializerExpr
				ClassExpr
			classTypeUsedInEvent
	MethodDeclaration
		BlockStmt
			IfStmt
				Globals
				BlockStmt
					internalDoFilter
						request
						response
				BlockStmt
					VariableDeclarator
						request
						req
					VariableDeclarator
						response
						res
					TryStmt
						CatchClause
							BlockStmt
								VariableDeclarator
									getException
										pe
									e
								IfStmt
									e
									IfStmt
										e
										IfStmt
											e
											ThrowStmt
												getMessage
													e
												e
											ThrowStmt
												e
										ThrowStmt
											e
									ThrowStmt
										e
						BlockStmt
							doPrivileged
								MethodDeclaration
									BlockStmt
										internalDoFilter
											req
											res
										ReturnStmt
											NullLiteralExpr
								java
	MethodDeclaration
		BlockStmt
			IfStmt
				<
					pos
					n
				BlockStmt
					VariableDeclarator
						++
							pos
						filters
						filterConfig
					VariableDeclarator
						NullLiteralExpr
						filter
					TryStmt
						CatchClause
							BlockStmt
								IfStmt
									!=
										filter
										NullLiteralExpr
									fireInstanceEvent
										InstanceEvent
										filter
										request
										response
										e
										support
								ThrowStmt
									e
						CatchClause
							BlockStmt
								IfStmt
									!=
										filter
										NullLiteralExpr
									fireInstanceEvent
										InstanceEvent
										filter
										request
										response
										e
										support
								ThrowStmt
									e
						CatchClause
							BlockStmt
								IfStmt
									!=
										filter
										NullLiteralExpr
									fireInstanceEvent
										InstanceEvent
										filter
										request
										response
										e
										support
								ThrowStmt
									e
						CatchClause
							BlockStmt
								IfStmt
									!=
										filter
										NullLiteralExpr
									fireInstanceEvent
										InstanceEvent
										filter
										request
										response
										e
										support
								ThrowStmt
									getString
										StringLiteralExpr
										sm
									e
						BlockStmt
							filter
							getFilter
								filterConfig
							fireInstanceEvent
								InstanceEvent
								filter
								request
								response
								support
							IfStmt
								Globals
								BlockStmt
									doFilter
										request
										response
										filter
								BlockStmt
									VariableDeclarator
										request
										req
									VariableDeclarator
										response
										res
									VariableDeclarator
										getUserPrincipal
											req
										principal
									VariableDeclarator
										ArrayInitializerExpr
											req
											res
										args
									doAsPrivilege
										StringLiteralExpr
										filter
										classType
										args
										principal
										SecurityUtil
									args
									NullLiteralExpr
							fireInstanceEvent
								InstanceEvent
								filter
								request
								response
								support
					ReturnStmt
			TryStmt
				CatchClause
					BlockStmt
						fireInstanceEvent
							InstanceEvent
							servlet
							request
							response
							e
							support
						ThrowStmt
							e
				CatchClause
					BlockStmt
						fireInstanceEvent
							InstanceEvent
							servlet
							request
							response
							e
							support
						ThrowStmt
							e
				CatchClause
					BlockStmt
						fireInstanceEvent
							InstanceEvent
							servlet
							request
							response
							e
							support
						ThrowStmt
							e
				CatchClause
					BlockStmt
						fireInstanceEvent
							InstanceEvent
							servlet
							request
							response
							e
							support
						ThrowStmt
							getString
								StringLiteralExpr
								sm
							e
				BlockStmt
					IfStmt
						Globals
						BlockStmt
							set
								NullLiteralExpr
								lastServicedRequest
							set
								NullLiteralExpr
								lastServicedResponse
				BlockStmt
					IfStmt
						Globals
						BlockStmt
							set
								request
								lastServicedRequest
							set
								response
								lastServicedResponse
					fireInstanceEvent
						InstanceEvent
						servlet
						request
						response
						support
					IfStmt
						&&
							request
							response
						BlockStmt
							service
								request
								response
								servlet
						BlockStmt
							IfStmt
								Globals
								BlockStmt
									service
										request
										response
										servlet
								BlockStmt
									VariableDeclarator
										request
										req
									VariableDeclarator
										response
										res
									VariableDeclarator
										getUserPrincipal
											req
										principal
									VariableDeclarator
										ArrayInitializerExpr
											req
											res
										args
									doAsPrivilege
										StringLiteralExpr
										servlet
										classTypeUsedInService
										args
										principal
										SecurityUtil
									args
									NullLiteralExpr
					fireInstanceEvent
						InstanceEvent
						servlet
						request
						response
						support
	MethodDeclaration
		BlockStmt
			IfStmt
				Globals
				BlockStmt
					internalDoFilterEvent
						event
				BlockStmt
					VariableDeclarator
						event
						ev
					TryStmt
						CatchClause
							BlockStmt
								VariableDeclarator
									getException
										pe
									e
								IfStmt
									e
									IfStmt
										e
										IfStmt
											e
											ThrowStmt
												getMessage
													e
												e
											ThrowStmt
												e
										ThrowStmt
											e
									ThrowStmt
										e
						BlockStmt
							doPrivileged
								MethodDeclaration
									BlockStmt
										internalDoFilterEvent
											ev
										ReturnStmt
											NullLiteralExpr
								java
	MethodDeclaration
		BlockStmt
			ReturnStmt
				get
					lastServicedRequest
	MethodDeclaration
		BlockStmt
			ReturnStmt
				get
					lastServicedResponse
	MethodDeclaration
		BlockStmt
			IfStmt
				<
					pos
					n
				BlockStmt
					VariableDeclarator
						++
							pos
						filters
						filterConfig
					VariableDeclarator
						NullLiteralExpr
						filter
					TryStmt
						CatchClause
							BlockStmt
								ThrowStmt
									e
						CatchClause
							BlockStmt
								ThrowStmt
									e
						CatchClause
							BlockStmt
								ThrowStmt
									e
						CatchClause
							BlockStmt
								ThrowStmt
									getString
										StringLiteralExpr
										sm
									e
						BlockStmt
							filter
							getFilter
								filterConfig
							IfStmt
								Globals
								BlockStmt
									doFilterEvent
										event
										filter
								BlockStmt
									VariableDeclarator
										event
										ev
									VariableDeclarator
										getUserPrincipal
											getHttpServletRequest
												ev
										principal
									VariableDeclarator
										ArrayInitializerExpr
											ev
										args
									doAsPrivilege
										StringLiteralExpr
										filter
										cometClassType
										args
										principal
										SecurityUtil
									args
									NullLiteralExpr
					ReturnStmt
			TryStmt
				CatchClause
					BlockStmt
						ThrowStmt
							e
				CatchClause
					BlockStmt
						ThrowStmt
							e
				CatchClause
					BlockStmt
						ThrowStmt
							e
				CatchClause
					BlockStmt
						ThrowStmt
							getString
								StringLiteralExpr
								sm
							e
				BlockStmt
					IfStmt
						Globals
						BlockStmt
							event
								event
								servlet
						BlockStmt
							VariableDeclarator
								event
								ev
							VariableDeclarator
								getUserPrincipal
									getHttpServletRequest
										ev
								principal
							VariableDeclarator
								ArrayInitializerExpr
									ev
								args
							doAsPrivilege
								StringLiteralExpr
								servlet
								classTypeUsedInEvent
								args
								principal
								SecurityUtil
							args
							NullLiteralExpr
	MethodDeclaration
		BlockStmt
			IfStmt
				==
					n
					filters
				BlockStmt
					VariableDeclarator
						+
							n
							INCREMENT
						newFilters
					arraycopy
						filters
						newFilters
						n
						System
					filters
					newFilters
			++
				n
			filters
			filterConfig
	MethodDeclaration
		BlockStmt
			ForStmt
				BlockStmt
					i
					filters
					NullLiteralExpr
				<
					i
					n
				VariableDeclarator
					i
					PrimitiveType
				++
					i
			n
			pos
			servlet
			NullLiteralExpr
			support
			NullLiteralExpr
	MethodDeclaration
		BlockStmt
			pos
	MethodDeclaration
		BlockStmt
			servlet
	MethodDeclaration
		BlockStmt
			support
